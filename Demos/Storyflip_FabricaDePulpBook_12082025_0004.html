<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infogr√°fico: Estrat√©gia de RPG no Instagram</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Brilliant Blues -->
    <!-- Application Structure Plan: A single-page, top-to-bottom infographic telling a strategic story. It starts with the broad market opportunity (The Why), moves to a competitive analysis (The Where), narrows to a project-specific SWOT (The What), and concludes with a clear, actionable strategy (The How), now including a full suite of AI-powered tools for the entire creative workflow, from high-level story structure to community management. -->
    <!-- Visualization & Content Choices: 
        - Market Stats (Report 1.1) -> Goal: Inform -> Method: Large stat cards -> Justification: High-impact, immediate communication of key numbers.
        - Platform Comparison (Table 1) -> Goal: Compare -> Method: Custom HTML/CSS table with icons -> Justification: A simplified visual summary of the detailed table.
        - SWOT Analysis (Report 2) -> Goal: Organize/Analyze -> Method: Four-quadrant HTML/CSS grid -> Justification: Classic, instantly recognizable layout for strategic analysis.
        - Monetization Funnel (Report 3.2) -> Goal: Explain Process -> Method: HTML/CSS flow diagram -> Justification: Visualizes the user journey from free content to paid support.
        - AI Ideation Tool -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Addresses the "content creation burden" weakness.
        - AI Image Prompt Generator -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Tackles the "visual production burden".
        - AI Interaction Generator -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Tackles "poll fatigue" by generating creative choices.
        - AI Lore Generator -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Tackles "content saturation" by enabling deep, unique world-building.
        - AI Monetization Helper -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Provides actionable, creative ideas for Patreon tiers.
        - AI Social Media Helper -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Assists with writing engaging Instagram captions.
        - AI Community Helper -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Helps maintain an active Discord community.
        - AI Story Arc Planner -> Goal: Demonstrate Solution -> Method: Interactive input with Gemini API call -> Justification: Directly solves the "narrative cohesion" weakness by providing a high-level story structure.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8FAFC; 
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 40vh;
        }
        .card {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            border: 1px solid #E2E8F0;
        }
        .section-title {
            color: #004AAD;
        }
        .stat-number {
            color: #0075C2;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0075C2;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">

        <header class="text-center mb-12 md:mb-16">
            <h1 class="text-4xl md:text-5xl font-bold section-title mb-4">O RPG do Instagram</h1>
            <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">Uma an√°lise visual da estrat√©gia para transformar uma ideia criativa num neg√≥cio sustent√°vel na economia dos criadores.</p>
        </header>

        <section id="api-key-setup" class="mb-12 md:mb-16">
            <div class="card max-w-2xl mx-auto">
                <h2 class="text-2xl font-bold text-center mb-4 section-title">Configura√ß√£o da API Gemini</h2>
                <p class="text-center text-gray-600 mb-4">Para que as funcionalidades de IA funcionem, precisa de uma chave da API Gemini. Pode obter uma gratuitamente no <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-blue-600 hover:underline">Google AI Studio</a>.</p>
                <div class="flex flex-col sm:flex-row gap-2">
                    <input type="password" id="api-key-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Insira a sua chave da API aqui">
                    <button id="save-api-key-btn" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition duration-300">Guardar Chave</button>
                </div>
                <p id="api-key-status" class="text-center text-green-600 mt-2 h-4"></p>
            </div>
        </section>

        <section id="opportunity" class="mb-12 md:mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 section-title">A Oportunidade de Mercado √© Real</h2>
            <p class="text-center text-gray-600 max-w-2xl mx-auto mb-10">O projeto n√£o existe no v√°cuo. Ele est√° posicionado na intersec√ß√£o de tr√™s tend√™ncias de mercado poderosas e em crescimento.</p>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 text-center">
                <div class="card">
                    <div class="text-5xl mb-4">üì±</div>
                    <h3 class="text-xl font-bold mb-2">Dom√≠nio M√≥vel</h3>
                    <p class="stat-number text-5xl font-bold">48.8%</p>
                    <p class="text-gray-600 mt-2">dos jogadores no Brasil preferem smartphones, validando a abordagem "mobile-first".</p>
                </div>
                <div class="card">
                    <div class="text-5xl mb-4">üìö</div>
                    <h3 class="text-xl font-bold mb-2">Apetite por Hist√≥rias</h3>
                    <p class="stat-number text-5xl font-bold">86%</p>
                    <p class="text-gray-600 mt-2">das vendas de livros s√£o de g√©neros como Fantasia e Fic√ß√£o Cient√≠fica, o p√∫blico-alvo ideal.</p>
                </div>
                <div class="card md:col-span-2 lg:col-span-1">
                    <div class="text-5xl mb-4">üé≤</div>
                    <h3 class="text-xl font-bold mb-2">Crescimento Narrativo</h3>
                    <p class="stat-number text-5xl font-bold">+122%</p>
                    <p class="text-gray-600 mt-2">√© o crescimento previsto para o mercado de TTRPGs at√© 2032, mostrando uma forte procura.</p>
                </div>
            </div>
        </section>

        <section id="landscape" class="mb-12 md:mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 section-title">Onde Jogar? O Cen√°rio das Plataformas</h2>
            <p class="text-center text-gray-600 max-w-2xl mx-auto mb-10">Nenhuma plataforma √© perfeita. O sucesso reside em usar cada uma para as suas for√ßas, criando um ecossistema h√≠brido.</p>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="card text-center border-t-4 border-blue-500">
                    <h3 class="text-2xl font-bold mb-2">Instagram</h3>
                    <p class="text-gray-500 mb-4">O Palco</p>
                    <p class="text-green-600 font-semibold mb-2">‚úì Aquisi√ß√£o de P√∫blico</p>
                    <p class="text-green-600 font-semibold mb-2">‚úì Narrativa Visual</p>
                    <p class="text-red-600 font-semibold">‚úó Comunidade Profunda</p>
                    <p class="text-red-600 font-semibold">‚úó Mec√¢nicas de Jogo</p>
                </div>
                <div class="card text-center border-t-4 border-indigo-500">
                    <h3 class="text-2xl font-bold mb-2">Discord</h3>
                    <p class="text-gray-500 mb-4">O Clube</p>
                    <p class="text-green-600 font-semibold mb-2">‚úì Comunidade Profunda</p>
                    <p class="text-green-600 font-semibold mb-2">‚úì Mec√¢nicas (com bots)</p>
                    <p class="text-red-600 font-semibold">‚úó Aquisi√ß√£o de P√∫blico</p>
                    <p class="text-red-600 font-semibold">‚úó Narrativa Visual</p>
                </div>
                <div class="card text-center border-t-4 border-pink-500">
                    <h3 class="text-2xl font-bold mb-2">Patreon</h3>
                    <p class="text-gray-500 mb-4">O Motor</p>
                    <p class="text-green-600 font-semibold mb-2">‚úì Monetiza√ß√£o Segura</p>
                    <p class="text-green-600 font-semibold mb-2">‚úì Conte√∫do Exclusivo</p>
                    <p class="text-red-600 font-semibold">‚úó Aquisi√ß√£o de P√∫blico</p>
                    <p class="text-red-600 font-semibold">‚úó Interatividade Nativa</p>
                </div>
            </div>
        </section>

        <section id="swot" class="mb-12 md:mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 section-title">An√°lise Estrat√©gica (SWOT)</h2>
            <p class="text-center text-gray-600 max-w-2xl mx-auto mb-10">Uma vis√£o clara dos fatores internos e externos que definem a estrat√©gia do projeto.</p>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="card">
                    <h3 class="text-xl font-bold text-green-600 mb-3">For√ßas üí™</h3>
                    <ul class="space-y-2 list-disc list-inside text-gray-700">
                        <li>Narrativa visual e imersiva</li>
                        <li>Interatividade nativa (enquetes, quizzes)</li>
                        <li>P√∫blico massivo e descoberta integrada</li>
                        <li>Baixa barreira de entrada para jogadores</li>
                    </ul>
                </div>
                <div class="card">
                    <h3 class="text-xl font-bold text-red-600 mb-3">Fraquezas üìâ</h3>
                    <ul class="space-y-2 list-disc list-inside text-gray-700">
                        <li>Falta de sistemas de jogo (dados, fichas)</li>
                        <li>Conte√∫do dos Stories √© ef√©mero</li>
                        <li>Elevado fardo de produ√ß√£o visual</li>
                        <li>Dif√≠cil manter a coes√£o narrativa</li>
                    </ul>
                </div>
                <div class="card">
                    <h3 class="text-xl font-bold text-blue-600 mb-3">Oportunidades üöÄ</h3>
                    <ul class="space-y-2 list-disc list-inside text-gray-700">
                        <li>Capturar o p√∫blico "curioso pela narrativa"</li>
                        <li>Fomentar a cocria√ß√£o com a comunidade</li>
                        <li>Alavancar o efeito "Bookstagram"</li>
                        <li>Tend√™ncia do conte√∫do serializado</li>
                    </ul>
                </div>
                <div class="card">
                    <h3 class="text-xl font-bold text-yellow-600 mb-3">Amea√ßas ‚ö†Ô∏è</h3>
                    <ul class="space-y-2 list-disc list-inside text-gray-700">
                        <li>Pol√≠ticas de monetiza√ß√£o vol√°teis</li>
                        <li>Desgaste do p√∫blico ("fadiga de enquetes")</li>
                        <li>Satura√ß√£o de conte√∫do na plataforma</li>
                        <li>Risco de Propriedade Intelectual (PI)</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="monetization-funnel" class="mb-12 md:mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 section-title">A Estrat√©gia do Funil de Monetiza√ß√£o</h2>
            <p class="text-center text-gray-600 max-w-2xl mx-auto mb-10">A abordagem mais segura e eficaz: usar o Instagram para construir um p√∫blico e o Patreon para gerar receita sustent√°vel.</p>
            
            <div class="w-full max-w-md mx-auto">
                <div class="card text-center p-6 mb-4">
                    <p class="text-sm font-bold uppercase tracking-wider text-gray-500">Topo do Funil</p>
                    <h3 class="text-2xl font-bold my-2">Aquisi√ß√£o de P√∫blico</h3>
                    <p class="text-5xl my-4">üì∏</p>
                    <p class="text-gray-600">Conte√∫do gratuito no Instagram para maximizar o alcance e a viralidade.</p>
                </div>
                <div class="text-center text-4xl text-gray-400 my-4">‚ñº</div>
                <div class="card text-center p-6 mb-4">
                    <p class="text-sm font-bold uppercase tracking-wider text-gray-500">Meio do Funil</p>
                    <h3 class="text-2xl font-bold my-2">Engajamento Comunit√°rio</h3>
                    <p class="text-5xl my-4">üí¨</p>
                    <p class="text-gray-600">Canalizar f√£s para o Discord para discuss√µes e constru√ß√£o de lealdade.</p>
                </div>
                <div class="text-center text-4xl text-gray-400 my-4">‚ñº</div>
                <div class="card text-center p-6 bg-blue-50 border-blue-200">
                    <p class="text-sm font-bold uppercase tracking-wider text-blue-600">Fundo do Funil</p>
                    <h3 class="text-2xl font-bold my-2 text-blue-800">Monetiza√ß√£o</h3>
                    <p class="text-5xl my-4">üí∞</p>
                    <p class="text-blue-700">F√£s dedicados apoiam o projeto no Patreon em troca de conte√∫do exclusivo.</p>
                </div>
            </div>
        </section>

        <section id="ai-tools" class="mb-12 md:mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 section-title">Seu Kit de Ferramentas Criativas com IA</h2>
            <p class="text-center text-gray-600 max-w-2xl mx-auto mb-10">Use a IA como sua assistente para superar os principais desafios da cria√ß√£o de conte√∫do, da idea√ß√£o √† gest√£o da comunidade.</p>

            <div class="grid lg:grid-cols-2 gap-8">
                <div class="card">
                    <h3 class="text-xl font-bold mb-3 text-blue-700">Potencializando a Criatividade ‚ú®</h3>
                    <div class="space-y-4">
                        <label for="prompt-input" class="block font-semibold text-gray-700">Conceito da hist√≥ria:</label>
                        <input type="text" id="prompt-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Ex: Um detetive num mundo de fantasia √©lfica...">
                        <button id="generate-ideas-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                            Gerar Ganchos de Enredo
                        </button>
                        <div id="ideas-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px]">
                            <p class="text-gray-500 text-sm">Suas ideias de enredo aparecer√£o aqui...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="text-xl font-bold mb-3 text-indigo-700">Visualizando o Mundo ‚ú®</h3>
                    <div class="space-y-4">
                        <label for="scene-input" class="block font-semibold text-gray-700">Descri√ß√£o da cena:</label>
                        <textarea id="scene-input" class="w-full p-2 border border-gray-300 rounded-md" rows="2" placeholder="Ex: O detetive √©lfico interroga um an√£o..."></textarea>
                        <button id="generate-prompt-btn" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-300 flex items-center justify-center">
                            Gerar Prompt de Imagem
                        </button>
                        <div id="prompt-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px]">
                            <p class="text-gray-500 text-sm">Seu prompt de imagem aparecer√° aqui...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="text-xl font-bold mb-3 text-teal-700">Criando Intera√ß√µes Cativantes ‚ú®</h3>
                    <div class="space-y-4">
                        <label for="decision-input" class="block font-semibold text-gray-700">Ponto de decis√£o:</label>
                        <textarea id="decision-input" class="w-full p-2 border border-gray-300 rounded-md" rows="2" placeholder="Ex: A hero√≠na encontra uma porta selada..."></textarea>
                        <button id="generate-choices-btn" class="w-full bg-teal-600 text-white font-bold py-2 px-4 rounded-md hover:bg-teal-700 transition duration-300 flex items-center justify-center">
                            Gerar Op√ß√µes de Voto
                        </button>
                        <div id="choices-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px]">
                            <p class="text-gray-500 text-sm">Suas op√ß√µes de voto aparecer√£o aqui...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="text-xl font-bold mb-3 text-purple-700">Aprofundando o Mundo ‚ú®</h3>
                    <div class="space-y-4">
                        <label for="lore-input" class="block font-semibold text-gray-700">Elemento do mundo:</label>
                        <input type="text" id="lore-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Ex: A Espada Sussurrante de √âbano...">
                        <button id="generate-lore-btn" class="w-full bg-purple-600 text-white font-bold py-2 px-4 rounded-md hover:bg-purple-700 transition duration-300 flex items-center justify-center">
                            Gerar Lore
                        </button>
                        <div id="lore-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px]">
                            <p class="text-gray-500 text-sm">A hist√≥ria do seu mundo aparecer√° aqui...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                     <h3 class="text-xl font-bold mb-3 text-pink-700">Planejando sua Monetiza√ß√£o ‚ú®</h3>
                     <div class="space-y-4">
                        <label for="monetization-input" class="block font-semibold text-gray-700">Conceito geral da sua hist√≥ria:</label>
                        <input type="text" id="monetization-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Ex: Uma aventura de fantasia sombria...">
                        <button id="generate-tiers-btn" class="w-full bg-pink-600 text-white font-bold py-2 px-4 rounded-md hover:bg-pink-700 transition duration-300 flex items-center justify-center">
                            Gerar Ideias para Patreon
                        </button>
                        <div id="tiers-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px]">
                            <p class="text-gray-500 text-sm">Suas ideias de n√≠veis aparecer√£o aqui...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                     <h3 class="text-xl font-bold mb-3 text-orange-700">Escrevendo Posts Cativantes ‚ú®</h3>
                     <div class="space-y-4">
                        <label for="post-input" class="block font-semibold text-gray-700">Descri√ß√£o do evento do post:</label>
                        <input type="text" id="post-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Ex: O her√≥i decide seguir o mapa antigo...">
                        <button id="generate-post-btn" class="w-full bg-orange-600 text-white font-bold py-2 px-4 rounded-md hover:bg-orange-700 transition duration-300 flex items-center justify-center">
                            Gerar Legenda para Post
                        </button>
                        <div id="post-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px] whitespace-pre-wrap">
                            <p class="text-gray-500 text-sm">Sua legenda para o Instagram aparecer√° aqui...</p>
                        </div>
                    </div>
                </div>

                 <div class="card">
                     <h3 class="text-xl font-bold mb-3 text-green-700">Engajando sua Comunidade ‚ú®</h3>
                     <div class="space-y-4">
                        <label for="community-input" class="block font-semibold text-gray-700">Descreva o √∫ltimo evento ou plot twist:</label>
                        <input type="text" id="community-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Ex: O her√≥i descobriu que o rei √© um impostor...">
                        <button id="generate-community-btn" class="w-full bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700 transition duration-300 flex items-center justify-center">
                            Gerar Perguntas para a Comunidade
                        </button>
                        <div id="community-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px]">
                            <p class="text-gray-500 text-sm">Suas perguntas para o Discord aparecer√£o aqui...</p>
                        </div>
                    </div>
                </div>

                <div class="card lg:col-span-2">
                     <h3 class="text-xl font-bold mb-3 text-slate-700">Planejando o Arco da Hist√≥ria ‚ú®</h3>
                     <div class="space-y-4">
                        <label for="arc-input" class="block font-semibold text-gray-700">Conceito central da sua hist√≥ria:</label>
                        <input type="text" id="arc-input" class="w-full p-2 border border-gray-300 rounded-md" placeholder="Ex: Um cavaleiro ca√≠do busca reden√ß√£o ca√ßando a fera que o amaldi√ßoou...">
                        <button id="generate-arc-btn" class="w-full bg-slate-600 text-white font-bold py-2 px-4 rounded-md hover:bg-slate-700 transition duration-300 flex items-center justify-center">
                            Gerar Estrutura de 3 Atos
                        </button>
                        <div id="arc-result" class="mt-4 p-3 border border-gray-200 rounded-md bg-gray-50 min-h-[120px]">
                            <p class="text-gray-500 text-sm">A estrutura da sua hist√≥ria aparecer√° aqui...</p>
                        </div>
                    </div>
                </div>

            </div>
        </section>
        
        <footer class="text-center mt-16 border-t pt-8 text-gray-500">
            <p>Este infogr√°fico √© uma representa√ß√£o visual da an√°lise estrat√©gica. O sucesso depende da execu√ß√£o consistente e da qualidade da narrativa.</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let geminiApiKey = '';

            const apiKeyInput = document.getElementById('api-key-input');
            const saveApiKeyBtn = document.getElementById('save-api-key-btn');
            const apiKeyStatus = document.getElementById('api-key-status');

            const generateIdeasBtn = document.getElementById('generate-ideas-btn');
            const promptInput = document.getElementById('prompt-input');
            const ideasResult = document.getElementById('ideas-result');

            const generatePromptBtn = document.getElementById('generate-prompt-btn');
            const sceneInput = document.getElementById('scene-input');
            const promptResult = document.getElementById('prompt-result');

            const generateChoicesBtn = document.getElementById('generate-choices-btn');
            const decisionInput = document.getElementById('decision-input');
            const choicesResult = document.getElementById('choices-result');

            const generateLoreBtn = document.getElementById('generate-lore-btn');
            const loreInput = document.getElementById('lore-input');
            const loreResult = document.getElementById('lore-result');

            const generateTiersBtn = document.getElementById('generate-tiers-btn');
            const monetizationInput = document.getElementById('monetization-input');
            const tiersResult = document.getElementById('tiers-result');

            const generatePostBtn = document.getElementById('generate-post-btn');
            const postInput = document.getElementById('post-input');
            const postResult = document.getElementById('post-result');

            const generateCommunityBtn = document.getElementById('generate-community-btn');
            const communityInput = document.getElementById('community-input');
            const communityResult = document.getElementById('community-result');

            const generateArcBtn = document.getElementById('generate-arc-btn');
            const arcInput = document.getElementById('arc-input');
            const arcResult = document.getElementById('arc-result');

            function saveApiKey() {
                const key = apiKeyInput.value;
                if (key) {
                    localStorage.setItem('geminiApiKey', key);
                    geminiApiKey = key;
                    apiKeyStatus.textContent = 'Chave API guardada com sucesso!';
                    setTimeout(() => { apiKeyStatus.textContent = '' }, 3000);
                }
            }

            function loadApiKey() {
                const savedKey = localStorage.getItem('geminiApiKey');
                if (savedKey) {
                    geminiApiKey = savedKey;
                    apiKeyInput.value = savedKey;
                }
            }
            
            saveApiKeyBtn.addEventListener('click', saveApiKey);
            loadApiKey();


            async function callGemini(fullPrompt, resultElement, buttonElement) {
                if (!geminiApiKey) {
                    resultElement.innerHTML = '<p class="text-red-500">Por favor, insira a sua chave da API Gemini na sec√ß√£o de configura√ß√£o no topo da p√°gina.</p>';
                    return null;
                }

                resultElement.innerHTML = '<div class="flex justify-center items-center h-full"><div class="loader"></div><p class="ml-3 text-gray-600">A gerar...</p></div>';
                buttonElement.disabled = true;

                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: fullPrompt }] });
                    const payload = { contents: chatHistory };
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${geminiApiKey}`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`Erro na API: ${response.statusText}`);
                    }

                    const result = await response.json();
                    
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        return text;
                    } else {
                        throw new Error("Resposta da API inv√°lida ou vazia.");
                    }
                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    resultElement.innerHTML = `<p class="text-red-500">Ocorreu um erro ao gerar. Por favor, tente novamente. Detalhes: ${error.message}</p>`;
                    return null;
                } finally {
                    buttonElement.disabled = false;
                }
            }

            function formatListResult(textResult) {
                return textResult
                    .split('\n')
                    .map(line => line.trim())
                    .filter(line => line.length > 0)
                    .map(line => {
                        if (line.startsWith('**Ato') || line.startsWith('**Ato')) {
                             return `<h4 class="font-bold mt-3">${line.replace(/\*|\:/g, '').trim()}</h4>`;
                        }
                        if (line.startsWith('* **') || line.startsWith('**')) {
                            return `<h4 class="font-bold mt-3">${line.replace(/\*|\:/g, '').trim()}</h4>`;
                        }
                        if (line.startsWith('*')) {
                             return `<li class="ml-4">${line.substring(1).trim()}</li>`;
                        }
                        return line;
                    })
                    .join('');
            }

            generateIdeasBtn.addEventListener('click', async () => {
                const userPrompt = promptInput.value;
                if (!userPrompt) {
                    ideasResult.innerHTML = '<p class="text-red-500">Por favor, insira um conceito para a hist√≥ria.</p>';
                    return;
                }
                const fullPrompt = `Como um mestre de RPG experiente, crie 3 ganchos de enredo curtos e intrigantes para uma hist√≥ria de RPG baseada no seguinte conceito. Cada gancho deve ser adequado para um post de Instagram, terminando com uma pergunta para engajar o p√∫blico. Formate a resposta como uma lista com marcadores simples. Conceito: "${userPrompt}"`;
                
                const textResult = await callGemini(fullPrompt, ideasResult, generateIdeasBtn);
                if (textResult) {
                    ideasResult.innerHTML = `<ul class="list-disc list-inside space-y-2">${formatListResult(textResult)}</ul>`;
                }
            });

            generatePromptBtn.addEventListener('click', async () => {
                const userScene = sceneInput.value;
                if (!userScene) {
                    promptResult.innerHTML = '<p class="text-red-500">Por favor, descreva uma cena.</p>';
                    return;
                }
                const fullPrompt = `Aja como um especialista em engenharia de prompts para geradores de imagem de IA como Midjourney. Crie um prompt detalhado e atmosf√©rico para gerar uma imagem baseada na seguinte cena. O prompt deve incluir detalhes sobre ilumina√ß√£o, composi√ß√£o, estilo de arte (ex: 'digital painting, cinematic'), e emo√ß√£o. A resposta deve ser apenas o prompt em si, sem texto adicional. Cena: "${userScene}"`;

                const textResult = await callGemini(fullPrompt, promptResult, generatePromptBtn);
                if (textResult) {
                    promptResult.innerHTML = `<p class="text-gray-700">${textResult}</p>`;
                }
            });

            generateChoicesBtn.addEventListener('click', async () => {
                const userDecision = decisionInput.value;
                if (!userDecision) {
                    choicesResult.innerHTML = '<p class="text-red-500">Por favor, descreva um ponto de decis√£o.</p>';
                    return;
                }
                const fullPrompt = `Aja como um roteirista criativo para uma hist√≥ria interativa no Instagram. Para o seguinte ponto de decis√£o, gere 3 op√ß√µes de voto criativas e n√£o √≥bvias para uma enquete. As op√ß√µes devem gerar curiosidade e evitar clich√™s como 'sim/n√£o'. Formate como uma lista com marcadores simples. Ponto de decis√£o: "${userDecision}"`;

                const textResult = await callGemini(fullPrompt, choicesResult, generateChoicesBtn);
                if(textResult) {
                    choicesResult.innerHTML = `<ul class="list-disc list-inside space-y-2">${formatListResult(textResult)}</ul>`;
                }
            });

            generateLoreBtn.addEventListener('click', async () => {
                const userLore = loreInput.value;
                if (!userLore) {
                    loreResult.innerHTML = '<p class="text-red-500">Por favor, insira um elemento do seu mundo.</p>';
                    return;
                }
                const fullPrompt = `Aja como um historiador e cronista de um mundo de fantasia. Crie uma entrada de lore curta e intrigante para o seguinte elemento do meu mundo. Descreva sua apar√™ncia, sua hist√≥ria e um segredo ou fato interessante sobre ele. A resposta deve ser um par√°grafo bem escrito. Elemento: "${userLore}"`;

                const textResult = await callGemini(fullPrompt, loreResult, generateLoreBtn);
                if(textResult) {
                    loreResult.innerHTML = `<p class="text-gray-700">${textResult}</p>`;
                }
            });

             generateTiersBtn.addEventListener('click', async () => {
                const userMonetization = monetizationInput.value;
                if (!userMonetization) {
                    tiersResult.innerHTML = '<p class="text-red-500">Por favor, insira um conceito para a hist√≥ria.</p>';
                    return;
                }
                const fullPrompt = `Aja como um especialista em monetiza√ß√£o para criadores de conte√∫do. Baseado no seguinte conceito de hist√≥ria, gere 3 n√≠veis (tiers) para o Patreon com nomes tem√°ticos e 2-3 ideias de recompensas (rewards) para cada um. Foque em recompensas digitais e de baixo custo de produ√ß√£o. Formate a resposta com o nome do n√≠vel em negrito e as recompensas como uma lista com marcadores. Conceito: "${userMonetization}"`;

                const textResult = await callGemini(fullPrompt, tiersResult, generateTiersBtn);
                if(textResult) {
                    tiersResult.innerHTML = `<ul>${formatListResult(textResult)}</ul>`;
                }
            });

            generatePostBtn.addEventListener('click', async () => {
                const userPost = postInput.value;
                if (!userPost) {
                    postResult.innerHTML = '<p class="text-red-500">Por favor, descreva o evento do post.</p>';
                    return;
                }
                const fullPrompt = `Aja como um social media manager de uma hist√≥ria interativa no Instagram. Escreva uma legenda cativante para um post. A legenda deve incluir um par√°grafo narrativo, uma chamada para a√ß√£o clara (ex: "O que ele deve fazer? Vote nos Stories!") e 3 a 5 hashtags relevantes. O evento do post √©: "${userPost}"`;

                const textResult = await callGemini(fullPrompt, postResult, generatePostBtn);
                if(textResult) {
                    postResult.innerHTML = `<p class="text-gray-700">${textResult}</p>`;
                }
            });

            generateCommunityBtn.addEventListener('click', async () => {
                const userCommunity = communityInput.value;
                if (!userCommunity) {
                    communityResult.innerHTML = '<p class="text-red-500">Por favor, descreva um evento da hist√≥ria.</p>';
                    return;
                }
                const fullPrompt = `Aja como um gestor de comunidade para uma hist√≥ria de fic√ß√£o interativa. Baseado no seguinte evento da hist√≥ria, gere 3 perguntas abertas e instigantes para postar num servidor de Discord e fomentar a discuss√£o e teorias dos f√£s. Formate como uma lista com marcadores simples. Evento: "${userCommunity}"`;

                const textResult = await callGemini(fullPrompt, communityResult, generateCommunityBtn);
                if(textResult) {
                    communityResult.innerHTML = `<ul class="list-disc list-inside space-y-2">${formatListResult(textResult)}</ul>`;
                }
            });

            generateArcBtn.addEventListener('click', async () => {
                const userArc = arcInput.value;
                if (!userArc) {
                    arcResult.innerHTML = '<p class="text-red-500">Por favor, insira um conceito para a hist√≥ria.</p>';
                    return;
                }
                const fullPrompt = `Aja como um roteirista profissional. Baseado no seguinte conceito de hist√≥ria, delineie uma estrutura cl√°ssica de tr√™s atos (Ato 1: Apresenta√ß√£o, Ato 2: Confronto, Ato 3: Resolu√ß√£o). Para cada ato, forne√ßa 2-3 pontos-chave do enredo. Formate a resposta de forma clara com t√≠tulos para cada ato. Conceito: "${userArc}"`;

                const textResult = await callGemini(fullPrompt, arcResult, generateArcBtn);
                if(textResult) {
                    arcResult.innerHTML = `<ul>${formatListResult(textResult)}</ul>`;
                }
            });
        });
    </script>

</body>
</ht
